

CREATE TABLE public.activity_logs (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid,
  category text NOT NULL,
  action text NOT NULL,
  points integer NOT NULL,
  metadata jsonb,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT activity_logs_pkey PRIMARY KEY (id),
  CONSTRAINT activity_logs_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.admin_logs (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  admin_id uuid,
  action_type character varying NOT NULL,
  target_type character varying,
  target_id uuid,
  details jsonb DEFAULT '{}'::jsonb,
  ip_address inet,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT admin_logs_pkey PRIMARY KEY (id),
  CONSTRAINT admin_logs_admin_id_fkey FOREIGN KEY (admin_id) REFERENCES public.admins(id)
);
CREATE TABLE public.admin_setup_logs (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  ip_address inet,
  user_agent text,
  success boolean,
  email character varying,
  error_message text,
  CONSTRAINT admin_setup_logs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.admins (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  user_id uuid,
  name character varying NOT NULL,
  email character varying NOT NULL UNIQUE,
  role character varying DEFAULT 'admin'::character varying,
  permissions jsonb DEFAULT '{}'::jsonb,
  is_active boolean DEFAULT true,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT admins_pkey PRIMARY KEY (id),
  CONSTRAINT admins_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.application_notes (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  application_id uuid,
  application_type text NOT NULL CHECK (application_type = ANY (ARRAY['job'::text, 'internship'::text])),
  company_user_id uuid NOT NULL,
  note text NOT NULL,
  is_private boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT application_notes_pkey PRIMARY KEY (id),
  CONSTRAINT application_notes_company_user_id_fkey FOREIGN KEY (company_user_id) REFERENCES public.company_users(id)
);
CREATE TABLE public.chat_messages (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  user_id uuid,
  message text NOT NULL,
  type character varying CHECK (type::text = ANY (ARRAY['user'::character varying, 'bot'::character varying]::text[])),
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT chat_messages_pkey PRIMARY KEY (id),
  CONSTRAINT chat_messages_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.chat_sessions (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  user_id uuid,
  started_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  ended_at timestamp without time zone,
  message_count integer DEFAULT 0,
  satisfaction_rating integer CHECK (satisfaction_rating >= 1 AND satisfaction_rating <= 5),
  feedback text,
  CONSTRAINT chat_sessions_pkey PRIMARY KEY (id),
  CONSTRAINT chat_sessions_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.chatbot_faqs (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  category character varying NOT NULL,
  question text NOT NULL,
  answer text NOT NULL,
  keywords ARRAY,
  view_count integer DEFAULT 0,
  helpful_count integer DEFAULT 0,
  is_active boolean DEFAULT true,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  updated_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT chatbot_faqs_pkey PRIMARY KEY (id)
);
CREATE TABLE public.chatbot_feedback (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  user_id uuid,
  message_id uuid,
  is_helpful boolean NOT NULL,
  feedback_text text,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT chatbot_feedback_pkey PRIMARY KEY (id),
  CONSTRAINT chatbot_feedback_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT chatbot_feedback_message_id_fkey FOREIGN KEY (message_id) REFERENCES public.chat_messages(id)
);
CREATE TABLE public.companies (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  name text NOT NULL,
  logo_url text,
  description text,
  sector text,
  employee_count text,
  website text,
  phone text,
  address text,
  city text,
  verified boolean DEFAULT false,
  tax_number text UNIQUE,
  trade_registry_number text,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  updated_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  email character varying,
  founded_year integer,
  linkedin character varying,
  twitter character varying,
  facebook character varying,
  instagram character varying,
  cover_image_url text,
  active_jobs_count integer DEFAULT 0,
  total_applications integer DEFAULT 0,
  hired_count integer DEFAULT 0,
  avg_response_time_hours numeric DEFAULT 0,
  profile_completion_score integer DEFAULT 0,
  approval_status character varying DEFAULT 'pending'::character varying,
  approved_at timestamp without time zone,
  approved_by uuid,
  rejection_reason text,
  has_active_subscription boolean DEFAULT false,
  subscription_end_date date,
  banned_at timestamp without time zone,
  CONSTRAINT companies_pkey PRIMARY KEY (id),
  CONSTRAINT companies_approved_by_fkey FOREIGN KEY (approved_by) REFERENCES public.admins(id)
);
CREATE TABLE public.company_metrics (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  company_id uuid,
  metric_date date NOT NULL,
  total_views integer DEFAULT 0,
  unique_visitors integer DEFAULT 0,
  total_applications integer DEFAULT 0,
  accepted_applications integer DEFAULT 0,
  rejected_applications integer DEFAULT 0,
  avg_response_time_hours numeric DEFAULT 0,
  conversion_rate numeric DEFAULT 0,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  CONSTRAINT company_metrics_pkey PRIMARY KEY (id),
  CONSTRAINT company_metrics_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id)
);
CREATE TABLE public.company_subscriptions (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  company_id uuid NOT NULL,
  plan_type text NOT NULL DEFAULT 'free'::text CHECK (plan_type = ANY (ARRAY['free'::text, 'starter'::text, 'professional'::text, 'enterprise'::text])),
  job_post_limit integer DEFAULT 3,
  active_job_limit integer DEFAULT 1,
  starts_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  ends_at timestamp with time zone,
  is_active boolean DEFAULT true,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT company_subscriptions_pkey PRIMARY KEY (id),
  CONSTRAINT company_subscriptions_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id)
);
CREATE TABLE public.company_users (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  company_id uuid NOT NULL,
  user_id uuid NOT NULL,
  role text NOT NULL DEFAULT 'member'::text CHECK (role = ANY (ARRAY['owner'::text, 'admin'::text, 'hr'::text, 'member'::text])),
  permissions jsonb DEFAULT '{"can_edit_job": true, "can_create_job": true, "can_view_applications": true}'::jsonb,
  invited_by uuid,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT company_users_pkey PRIMARY KEY (id),
  CONSTRAINT company_users_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id),
  CONSTRAINT company_users_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT company_users_invited_by_fkey FOREIGN KEY (invited_by) REFERENCES auth.users(id)
);
CREATE TABLE public.completed_courses (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  course_id uuid NOT NULL,
  completed_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT completed_courses_pkey PRIMARY KEY (id),
  CONSTRAINT fk_user FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT fk_course FOREIGN KEY (course_id) REFERENCES public.courses(id)
);
CREATE TABLE public.course_enrollments (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  course_id uuid NOT NULL,
  enrolled_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  progress integer DEFAULT 0,
  CONSTRAINT course_enrollments_pkey PRIMARY KEY (id),
  CONSTRAINT fk_enroll_user FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT fk_enroll_course FOREIGN KEY (course_id) REFERENCES public.courses(id)
);
CREATE TABLE public.course_reviews (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  course_id uuid NOT NULL,
  rating integer NOT NULL CHECK (rating >= 1 AND rating <= 5),
  comment text,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT course_reviews_pkey PRIMARY KEY (id),
  CONSTRAINT fk_review_user FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT fk_review_course FOREIGN KEY (course_id) REFERENCES public.courses(id)
);
CREATE TABLE public.courses (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  title text NOT NULL,
  description text,
  department text,
  video_url text,
  duration text,
  level text,
  instructor text,
  CONSTRAINT courses_pkey PRIMARY KEY (id)
);
CREATE TABLE public.employer_ratings (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  employer_id uuid,
  student_id uuid,
  internship_id uuid,
  rating integer CHECK (rating >= 10 AND rating <= 50),
  comment text,
  rated_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT employer_ratings_pkey PRIMARY KEY (id),
  CONSTRAINT employer_ratings_employer_id_fkey FOREIGN KEY (employer_id) REFERENCES auth.users(id),
  CONSTRAINT employer_ratings_student_id_fkey FOREIGN KEY (student_id) REFERENCES auth.users(id),
  CONSTRAINT employer_ratings_internship_id_fkey FOREIGN KEY (internship_id) REFERENCES public.internships(id)
);
CREATE TABLE public.favorites (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  course_id uuid,
  type text NOT NULL,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  job_id uuid,
  internship_id uuid,
  CONSTRAINT favorites_pkey PRIMARY KEY (id),
  CONSTRAINT fk_fav_user FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT fk_fav_course FOREIGN KEY (course_id) REFERENCES public.courses(id),
  CONSTRAINT fk_fav_job FOREIGN KEY (job_id) REFERENCES public.jobs(id),
  CONSTRAINT fk_fav_internship FOREIGN KEY (internship_id) REFERENCES public.internships(id)
);
CREATE TABLE public.intern_evaluations (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  internship_application_id uuid NOT NULL UNIQUE,
  company_id uuid NOT NULL,
  performance_score integer NOT NULL,
  attendance_score integer NOT NULL,
  team_work_score integer NOT NULL,
  technical_score integer NOT NULL,
  final_rating integer NOT NULL,
  would_hire_again boolean DEFAULT false,
  comments text,
  evaluated_by uuid NOT NULL,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT intern_evaluations_pkey PRIMARY KEY (id),
  CONSTRAINT intern_evaluations_internship_application_id_fkey FOREIGN KEY (internship_application_id) REFERENCES public.internship_applications(id),
  CONSTRAINT intern_evaluations_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id),
  CONSTRAINT intern_evaluations_evaluated_by_fkey FOREIGN KEY (evaluated_by) REFERENCES auth.users(id)
);
CREATE TABLE public.internship_applications (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid,
  internship_id uuid,
  motivation_letter text,
  status text DEFAULT 'pending'::text CHECK (status = ANY (ARRAY['pending'::text, 'accepted'::text, 'rejected'::text])),
  applied_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  is_completed boolean DEFAULT false,
  employer_rating integer CHECK (employer_rating >= 1 AND employer_rating <= 5),
  employer_feedback text,
  completion_date timestamp with time zone,
  points_awarded integer,
  CONSTRAINT internship_applications_pkey PRIMARY KEY (id),
  CONSTRAINT internship_applications_internship_id_fkey FOREIGN KEY (internship_id) REFERENCES public.internships(id),
  CONSTRAINT internship_applications_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.internship_views (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  internship_id uuid,
  user_id uuid,
  viewed_at timestamp with time zone DEFAULT now(),
  ip_address inet,
  user_agent text,
  session_id text,
  CONSTRAINT internship_views_pkey PRIMARY KEY (id),
  CONSTRAINT internship_views_internship_id_fkey FOREIGN KEY (internship_id) REFERENCES public.internships(id),
  CONSTRAINT internship_views_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.internships (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  title text NOT NULL,
  description text,
  department text,
  start_date date,
  end_date date,
  created_at timestamp without time zone DEFAULT timezone('utc'::text, now()),
  company_name text,
  location text,
  salary numeric,
  duration_months integer,
  is_remote boolean DEFAULT false,
  quota integer DEFAULT 1,
  is_active boolean DEFAULT true,
  company_id uuid,
  created_by uuid,
  requirements text,
  benefits text,
  work_type text DEFAULT 'on-site'::text,
  deadline date,
  is_paid boolean DEFAULT false,
  monthly_stipend text,
  provides_certificate boolean DEFAULT true,
  possibility_of_employment boolean DEFAULT false,
  CONSTRAINT internships_pkey PRIMARY KEY (id),
  CONSTRAINT internships_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id),
  CONSTRAINT internships_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id)
);
CREATE TABLE public.job_applications (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  job_id uuid NOT NULL,
  cover_letter text,
  status text DEFAULT 'pending'::text CHECK (status = ANY (ARRAY['pending'::text, 'accepted'::text, 'rejected'::text])),
  applied_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  cv_url text,
  notes text,
  interview_date timestamp with time zone,
  reviewed boolean DEFAULT false,
  CONSTRAINT job_applications_pkey PRIMARY KEY (id),
  CONSTRAINT fk_application_user FOREIGN KEY (user_id) REFERENCES auth.users(id),
  CONSTRAINT fk_application_job FOREIGN KEY (job_id) REFERENCES public.jobs(id)
);
CREATE TABLE public.job_templates (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  company_id uuid NOT NULL,
  title text NOT NULL,
  description text,
  requirements ARRAY,
  responsibilities ARRAY,
  benefits text,
  created_by uuid NOT NULL,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT job_templates_pkey PRIMARY KEY (id),
  CONSTRAINT job_templates_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id),
  CONSTRAINT job_templates_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id)
);
CREATE TABLE public.job_views (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  job_id uuid,
  user_id uuid,
  viewed_at timestamp with time zone DEFAULT now(),
  ip_address inet,
  user_agent text,
  session_id text,
  CONSTRAINT job_views_pkey PRIMARY KEY (id),
  CONSTRAINT job_views_job_id_fkey FOREIGN KEY (job_id) REFERENCES public.jobs(id),
  CONSTRAINT job_views_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.jobs (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  title text NOT NULL,
  description text,
  department text,
  company text,
  created_at timestamp without time zone DEFAULT now(),
  type text NOT NULL DEFAULT 'departmental'::text CHECK (type = ANY (ARRAY['departmental'::text, 'part-time'::text])),
  location text,
  salary text,
  work_type text DEFAULT 'full-time'::text,
  is_remote boolean DEFAULT false,
  is_active boolean DEFAULT true,
  deadline date,
  contact_email text,
  benefits text,
  min_year integer,
  max_year integer,
  company_id uuid,
  created_by uuid,
  requirements text,
  views_count integer DEFAULT 0,
  application_count integer DEFAULT 0,
  CONSTRAINT jobs_pkey PRIMARY KEY (id),
  CONSTRAINT jobs_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id),
  CONSTRAINT jobs_created_by_fkey FOREIGN KEY (created_by) REFERENCES auth.users(id)
);
CREATE TABLE public.leaderboard_snapshots (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  department text NOT NULL,
  points integer NOT NULL,
  rank_overall integer,
  rank_department integer,
  period_type text NOT NULL,
  period_date date NOT NULL,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT leaderboard_snapshots_pkey PRIMARY KEY (id),
  CONSTRAINT leaderboard_snapshots_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.notification_preferences (
  user_id uuid NOT NULL,
  email_notifications boolean DEFAULT true,
  new_course_notifications boolean DEFAULT true,
  job_alerts boolean DEFAULT true,
  newsletter boolean DEFAULT false,
  updated_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT notification_preferences_pkey PRIMARY KEY (user_id),
  CONSTRAINT notification_preferences_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.notifications (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  type text NOT NULL,
  title text NOT NULL,
  message text NOT NULL,
  is_read boolean DEFAULT false,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  icon text,
  action_url text,
  CONSTRAINT notifications_pkey PRIMARY KEY (id),
  CONSTRAINT notifications_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.payments (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  company_id uuid,
  subscription_id uuid,
  amount numeric NOT NULL,
  currency character varying DEFAULT 'TRY'::character varying,
  payment_method character varying,
  payment_status character varying,
  transaction_id character varying,
  payment_gateway character varying,
  gateway_response jsonb,
  paid_at timestamp without time zone,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  CONSTRAINT payments_pkey PRIMARY KEY (id),
  CONSTRAINT payments_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id),
  CONSTRAINT payments_subscription_id_fkey FOREIGN KEY (subscription_id) REFERENCES public.company_subscriptions(id)
);
CREATE TABLE public.profiles (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  email text,
  department text,
  year integer,
  full_name text,
  phone text,
  total_points integer DEFAULT 0,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  updated_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT profiles_pkey PRIMARY KEY (id),
  CONSTRAINT profiles_id_fkey FOREIGN KEY (id) REFERENCES auth.users(id)
);
CREATE TABLE public.report_cache (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  company_id uuid,
  report_type text NOT NULL,
  report_data jsonb NOT NULL,
  generated_at timestamp with time zone DEFAULT now(),
  expires_at timestamp with time zone NOT NULL,
  parameters jsonb,
  CONSTRAINT report_cache_pkey PRIMARY KEY (id),
  CONSTRAINT report_cache_company_id_fkey FOREIGN KEY (company_id) REFERENCES public.companies(id)
);
CREATE TABLE public.rewards (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  title text NOT NULL,
  description text,
  required_points integer NOT NULL,
  department text,
  icon text,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT rewards_pkey PRIMARY KEY (id)
);
CREATE TABLE public.subscription_plans (
  id uuid NOT NULL DEFAULT uuid_generate_v4(),
  name character varying NOT NULL,
  price_monthly numeric,
  price_yearly numeric,
  features jsonb,
  is_active boolean DEFAULT true,
  created_at timestamp without time zone DEFAULT CURRENT_TIMESTAMP,
  slug text UNIQUE,
  max_active_jobs integer,
  max_active_internships integer,
  CONSTRAINT subscription_plans_pkey PRIMARY KEY (id)
);
CREATE TABLE public.user_badges (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid NOT NULL,
  badge_type text NOT NULL,
  badge_title text NOT NULL,
  badge_description text,
  icon text,
  earned_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  points_awarded integer DEFAULT 0,
  CONSTRAINT user_badges_pkey PRIMARY KEY (id),
  CONSTRAINT user_badges_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);
CREATE TABLE public.user_points (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  user_id uuid,
  source text NOT NULL,
  description text,
  points integer NOT NULL,
  created_at timestamp with time zone DEFAULT timezone('utc'::text, now()),
  CONSTRAINT user_points_pkey PRIMARY KEY (id),
  CONSTRAINT user_points_user_id_fkey FOREIGN KEY (user_id) REFERENCES auth.users(id)
);